var FPLAnalyzer=angular.module("FPLAnalyzer",[]).controller("FPLCtrl",["$scope","$window",function(b,f){b.exportData=function(){var c="Launch to Waiting for Customer "+b.formatDate(Date.now())+".csv",a=[["Name","Uses","Cards from Launch to Waiting","Launch to Waiting for Customer Average"]],d=b.stats.labels,e;for(e in d)d.hasOwnProperty(e)&&a.push([d[e].name,d[e].uses,d[e].launchToWaitingCount,b.avgDays(d[e].launchToWaitingCount,d[e].launchToWaitingSum)]);exportToCSV(c,a)};b.toggleSort=function(c){c.field===
b.search.sort?(b.search.reverse=!b.search.reverse,$("#table .dir").eq(c.id).html('<i class="material-icons">arrow_drop_'+(b.search.reverse?"down":"up")+"</i>")):(b.search.sort=c.field,b.search.reverse=!1,$("#table .dir").html("").eq(c.id).html('<i class="material-icons">arrow_drop_up</i>'))};b.showPopup=function(c){b.popupPlayer=c;b.popupPlayer.url="https://platform-static-files.s3.amazonaws.com/premierleague/photos/players/110x140/p"+c.photo.slice(0,-4)+".png";$("#blur").fadeIn(200)};b.resetTable=
function(){b.search={limit:!0,limitSize:50,sort:"total_points",reverse:!0,teams:{all:!0},poss:{all:!0}};b.filters=[{name:"Total Points",field:"total_points"},{name:"GW Points",field:"event_points"},{name:"PPG",field:"points_per_game"},{name:"PPM",field:"value_season"},{name:"Form",field:"form"},{name:"FPM",field:"value_form"},{name:"Price",field:"now_cost"},{name:"VAPM",field:"value_added_per_mil"},{name:"Minutes",field:"minutes"},{name:"Transfers In",field:"transfers_in"},{name:"Transfers Out",field:"transfers_out"},
{name:"Net Transfers",field:"transfers_diff"},{name:"Transfers In (GW)",field:"transfers_in_event"},{name:"Transfers out (GW)",field:"transfers_out_event"},{name:"Net Transfers (GW)",field:"transfers_diff_event"},{name:"Selected By",field:"selected_by_percent"},{name:"Cost Change",field:"cost_change_start"},{name:"Cost Change (GW)",field:"cost_change_event"},{name:"ICT",field:"ict_index"},{name:"Threat",field:"threat"},{name:"Creativity",field:"creativity"},{name:"Influence",field:"influence"},{name:"Bonus",
field:"bonus"},{name:"BPS",field:"bps"},{name:"Goals",field:"goals_scored"},{name:"Assists",field:"assists"},{name:"CS",field:"clean_sheets"},{name:"Saves",field:"saves"},{name:"Conceded",field:"goals_conceded"},{name:"Yellow Cards",field:"yellow_cards"},{name:"Red Cards",field:"red_cards"}];b.cols=[{id:0,name:"Name",field:"web_name",show:!0},{id:1,name:"Team",field:"team",show:!0},{id:2,name:"Pos",field:"element_type",show:!0},{id:3,name:"Total Points",field:"total_points",show:!0},{id:4,name:"GW Points",
field:"event_points",show:!0},{id:5,name:"PPG",field:"points_per_game",show:!1},{id:6,name:"PPM",field:"value_season",show:!1},{id:7,name:"Form",field:"form",show:!0},{id:8,name:"FPM",field:"value_form",show:!1},{id:9,name:"Price",field:"now_cost",show:!0},{id:10,name:"VAPM",field:"value_added_per_mil",show:!0},{id:11,name:"Minutes",field:"minutes",show:!0},{id:12,name:"Transfers In",field:"transfers_in",show:!1},{id:13,name:"Transfers Out",field:"transfers_out",show:!1},{id:14,name:"Net Transfers",
field:"transfers_diff",show:!1},{id:15,name:"Transfers In (GW)",field:"transfers_in_event",show:!1},{id:16,name:"Transfers out (GW)",field:"transfers_out_event",show:!1},{id:17,name:"Net Transfers (GW)",field:"transfers_diff_event",show:!1},{id:18,name:"Selected By",field:"selected_by_percent",show:!0},{id:19,name:"Cost Change",field:"cost_change_start",show:!0},{id:20,name:"Cost Change (GW)",field:"cost_change_event",show:!0},{id:21,name:"ICT",field:"ict_index",show:!1},{id:22,name:"Threat",field:"threat",
show:!1},{id:23,name:"Creativity",field:"creativity",show:!1},{id:24,name:"Influence",field:"influence",show:!1},{id:25,name:"Bonus",field:"bonus",show:!1},{id:26,name:"BPS",field:"bps",show:!1},{id:27,name:"Goals",field:"goals_scored",show:!1},{id:28,name:"Assists",field:"assists",show:!1},{id:29,name:"CS",field:"clean_sheets",show:!1},{id:30,name:"Saves",field:"saves",show:!1},{id:31,name:"Conceded",field:"goals_conceded",show:!1},{id:32,name:"Yellow Cards",field:"yellow_cards",show:!1},{id:33,
name:"Red Cards",field:"red_cards",show:!1}]};b.filter=function(){var c=[];b.data.elements.forEach(function(a){var d=b.search,e=!0;a.creativity=parseFloat(a.creativity);a.form=parseFloat(a.form);a.ict_index=parseFloat(a.ict_index);a.influence=parseFloat(a.influence);a.points_per_game=parseFloat(a.points_per_game);a.selected_by_percent=parseFloat(a.selected_by_percent);a.threat=parseFloat(a.threat);a.value_form=parseFloat(a.value_form);a.value_season=parseFloat(a.value_season);a.value_added_per_mil=
(a.points_per_game-2)/(a.now_cost/10);a.transfers_diff=a.transfers_in-a.transfers_out;a.transfers_diff_event=a.transfers_in_event-a.transfers_out_event;d.name&&-1===a.web_name.toLowerCase().indexOf(d.name.toLowerCase())&&(e=!1);d.teams.all||d.teams[a.team]||(e=!1);d.poss.all||d.poss[a.element_type]||(e=!1);b.filters.some(function(b){return b.show&&!between(a[b.field],b.low,b.high)?(e=!1,!0):!1});e&&c.push(a)});b.filteredPlayers=c};b.resetTable();$.ajax({type:"GET",url:"https://json2jsonp.com/?url=https://fantasy.premierleague.com/drf/bootstrap-static",
dataType:"jsonp",success:function(c){$("#loading").hide();b.data=c;b.filteredPlayers=c.elements;b.$digest();b.filter();b.$digest()},error:console.log})}]);
