var FPLAnalyzer=angular.module("FPLAnalyzer",[]).directive("myCheckbox",function(){return{restrict:"E",scope:{myModel:"=",myChange:"="},template:'<div class="checkbox">\n\t\t\t<label><input type="checkbox" ng-model="myModel" ng-change="myChange">\n\t\t\t\t<i class="material-icons on">check_box</i>\n\t\t\t\t<i class="material-icons off">check_box_outline_blank</i>\n\t\t\t</label>\n\t\t</div>'}}).controller("FPLCtrl",["$scope","$window",function(b,f){b.f=function(){console.log("f")};b.exportData=function(){var a=
"Launch to Waiting for Customer "+b.formatDate(Date.now())+".csv",e=[["Name","Uses","Cards from Launch to Waiting","Launch to Waiting for Customer Average"]],c=b.stats.labels,d;for(d in c)c.hasOwnProperty(d)&&e.push([c[d].name,c[d].uses,c[d].launchToWaitingCount,b.avgDays(c[d].launchToWaitingCount,c[d].launchToWaitingSum)]);exportToCSV(a,e)};b.toggleSort=function(a){a.field===b.search.sort?(b.search.reverse=!b.search.reverse,$("#table .dir").eq(a.id).html('<i class="material-icons">arrow_drop_'+(b.search.reverse?
"down":"up")+"</i>")):(b.search.sort=a.field,b.search.reverse=!1,$("#table .dir").html("").eq(a.id).html('<i class="material-icons">arrow_drop_up</i>'))};b.showPopup=function(a){b.popupPlayer=a;b.popupPlayer.url="https://platform-static-files.s3.amazonaws.com/premierleague/photos/players/110x140/p"+a.photo.slice(0,-4)+".png";$("#blur").fadeIn(200)};b.resetTable=function(){b.search={limit:!0,limitSize:50,sort:"total_points",reverse:!0,teams:{all:!0},poss:{all:!0}};b.filters=[{label:"Total Points",
field:"total_points"},{label:"GW Points",field:"event_points"},{label:"PPG",field:"points_per_game"},{label:"PPM",field:"value_season"},{label:"Form",field:"form"},{label:"FPM",field:"value_form"},{label:"Price",field:"now_cost"},{label:"VAPM",field:"value_added_per_mil"},{label:"Minutes",field:"minutes"},{label:"Transfers In",field:"transfers_in"},{label:"Transfers Out",field:"transfers_out"},{label:"Net Transfers",field:"transfers_diff"},{label:"Transfers In (GW)",field:"transfers_in_event"},{label:"Transfers out (GW)",
field:"transfers_out_event"},{label:"Net Transfers (GW)",field:"transfers_diff_event"},{label:"Selected By",field:"selected_by_percent"},{label:"Cost Change",field:"cost_change_start"},{label:"Cost Change (GW)",field:"cost_change_event"},{label:"ICT",field:"ict_index"},{label:"Threat",field:"threat"},{label:"Creativity",field:"creativity"},{label:"Influence",field:"influence"},{label:"Bonus",field:"bonus"},{label:"BPS",field:"bps"},{label:"Goals",field:"goals_scored"},{label:"Assists",field:"assists"},
{label:"CS",field:"clean_sheets"},{label:"Saves",field:"saves"},{label:"Conceded",field:"goals_conceded"},{label:"Yellow Cards",field:"yellow_cards"},{label:"Red Cards",field:"red_cards"}];b.cols=[{id:0,label:"Name",field:"web_name",show:!0,full_label:!1},{id:1,label:"Team",field:"team",show:!0,full_label:!1},{id:2,label:"Pos",field:"element_type",show:!0,full_label:!1},{id:3,label:"Total Points",field:"total_points",show:!0,full_label:!1},{id:4,label:"GW Points",field:"event_points",show:!0,full_label:!1},
{id:5,label:"PPG",field:"points_per_game",show:!1,full_label:"Points Per Game"},{id:6,label:"PPM",field:"value_season",show:!1,full_label:"Points Per Million"},{id:7,label:"Form",field:"form",show:!0,full_label:!1},{id:8,label:"FPM",field:"value_form",show:!1,full_label:"Form Per Million"},{id:9,label:"Price",field:"now_cost",show:!0,full_label:!1},{id:10,label:"VAPM",field:"value_added_per_mil",show:!0,full_label:"Value Added Per Million"},{id:11,label:"Minutes",field:"minutes",show:!0,full_label:!1},
{id:12,label:"Transfers In",field:"transfers_in",show:!1,full_label:!1},{id:13,label:"Transfers Out",field:"transfers_out",show:!1,full_label:!1},{id:14,label:"Net Transfers",field:"transfers_diff",show:!1,full_label:!1},{id:15,label:"Transfers In (GW)",field:"transfers_in_event",show:!1,full_label:!1},{id:16,label:"Transfers out (GW)",field:"transfers_out_event",show:!1,full_label:!1},{id:17,label:"Net Transfers (GW)",field:"transfers_diff_event",show:!1,full_label:!1},{id:18,label:"Selected By",
field:"selected_by_percent",show:!0,full_label:!1},{id:19,label:"Cost Change",field:"cost_change_start",show:!0,full_label:!1},{id:20,label:"Cost Change (GW)",field:"cost_change_event",show:!0,full_label:!1},{id:21,label:"ICT",field:"ict_index",show:!1,full_label:!1},{id:22,label:"Threat",field:"threat",show:!1,full_label:!1},{id:23,label:"Creativity",field:"creativity",show:!1,full_label:!1},{id:24,label:"Influence",field:"influence",show:!1,full_label:!1},{id:25,label:"Bonus",field:"bonus",show:!1,
full_label:!1},{id:26,label:"BPS",field:"bps",show:!1,full_label:!1},{id:27,label:"Goals",field:"goals_scored",show:!1,full_label:!1},{id:28,label:"Assists",field:"assists",show:!1,full_label:!1},{id:29,label:"CS",field:"clean_sheets",show:!1,full_label:"Clean Sheets"},{id:30,label:"Saves",field:"saves",show:!1,full_label:!1},{id:31,label:"Conceded",field:"goals_conceded",show:!1,full_label:!1},{id:32,label:"Yellow Cards",field:"yellow_cards",show:!1,full_label:!1},{id:33,label:"Red Cards",field:"red_cards",
show:!1,full_label:!1}]};b.updatePlayers=function(){b.data.elements.forEach(function(a){a.now_cost=parseFloat(a.now_cost/10);a.creativity=parseFloat(a.creativity);a.form=parseFloat(a.form);a.ict_index=parseFloat(a.ict_index);a.influence=parseFloat(a.influence);a.points_per_game=parseFloat(a.points_per_game);a.selected_by_percent=parseFloat(a.selected_by_percent);a.threat=parseFloat(a.threat);a.value_form=parseFloat(a.value_form);a.value_season=parseFloat(a.value_season);a.value_added_per_mil=(a.points_per_game-
2)/a.now_cost;a.transfers_diff=a.transfers_in-a.transfers_out;a.transfers_diff_event=a.transfers_in_event-a.transfers_out_event})};b.filter=function(){var a=[];b.data&&(b.data.elements.forEach(function(e){var c=b.search,d=!0;c.name&&-1===e.web_name.toLowerCase().indexOf(c.name.toLowerCase())&&(d=!1);c.teams.all||c.teams[e.team]||(d=!1);c.poss.all||c.poss[e.element_type]||(d=!1);b.filters.some(function(a){return a.show&&!between(e[a.field],a.low,a.high)?(d=!1,!0):!1});d&&a.push(e)}),b.filteredPlayers=
a)};b.resetTable();$.ajax({type:"GET",url:"https://json2jsonp.com/?url=https://fantasy.premierleague.com/drf/bootstrap-static",dataType:"jsonp",success:function(a){$("#loading").hide();b.data=a;b.filteredPlayers=a.elements;b.updatePlayers();b.$digest()},error:console.log})}]);
